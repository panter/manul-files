{"version":3,"sources":["../src/resize.js"],"names":["require","e","file","maxDimension","quality","onResult","orientation","reader","global","FileReader","onload","readerEvent","image","Image","canvas","document","createElement","width","height","getContext","drawImage","toBlob","blob","src","target","result","readAsDataURL"],"mappings":";;;;;;AAEA;;;;AACA;;;;;;AAGA,IAAI;AACFA,UAAQ,wBAAR,EADE,CACiC;AACpC,CAFD,CAEE,OAAOC,CAAP,EAAU;AACV;AACD;;kBAEc,UAACC,IAAD,EAAgE;AAAA,iFAAjB,EAAiB;AAAA,+BAAvDC,YAAuD;AAAA,MAAvDA,YAAuD,qCAAxC,GAAwC;AAAA,0BAAnCC,OAAmC;AAAA,MAAnCA,OAAmC,gCAAzB,GAAyB;;AAAA,MAAbC,QAAa;;AAC7E;;AAEA,iCAAeH,IAAf,EAAqB,UAACI,WAAD,EAAiB;AACpC;AACA;AACA,QAAMC,SAAS,IAAIC,OAAOC,UAAX,EAAf;AACAF,WAAOG,MAAP,GAAgB,UAACC,WAAD,EAAiB;AAC/B,UAAMC,QAAQ,IAAIJ,OAAOK,KAAX,EAAd;AACAD,YAAMF,MAAN,GAAe,YAAM;AACT;AACV,YAAMI,SAASN,OAAOO,QAAP,CAAgBC,aAAhB,CAA8B,QAA9B,CAAf;AACA,YAAIC,QAAQL,MAAMK,KAAlB;AACA,YAAIC,SAASN,MAAMM,MAAnB;;AAEA,YAAID,QAAQC,MAAZ,EAAoB;AAClB,cAAID,QAAQd,YAAZ,EAA0B;AACxBe,sBAAUf,eAAec,KAAzB;AACAA,oBAAQd,YAAR;AACD;AACF,SALD,MAKO,IAAIe,SAASf,YAAb,EAA2B;AAChCc,mBAASd,eAAee,MAAxB;AACAA,mBAASf,YAAT;AACD;AACDW,eAAOG,KAAP,GAAeA,KAAf;AACAH,eAAOI,MAAP,GAAgBA,MAAhB;AACA,8BAAOJ,MAAP,EAAeG,KAAf,EAAsBC,MAAtB,EAA8BZ,WAA9B;AACAQ,eAAOK,UAAP,CAAkB,IAAlB,EAAwBC,SAAxB,CAAkCR,KAAlC,EAAyC,CAAzC,EAA4C,CAA5C,EAA+CK,KAA/C,EAAsDC,MAAtD;;AAEAJ,eAAOO,MAAP,CAAc,UAACC,IAAD,EAAU;AACtBjB,mBAAS,IAAT,EAAeiB,IAAf;AACD,SAFD,EAEG,YAFH,EAEiBlB,OAFjB;AAGD,OAvBD;AAwBAQ,YAAMW,GAAN,GAAYZ,YAAYa,MAAZ,CAAmBC,MAA/B;AACD,KA3BD;AA4BAlB,WAAOmB,aAAP,CAAqBxB,IAArB;AACD,GAjCD;AAkCD,C","file":"resize.js","sourcesContent":["\n\nimport getOrientation from './get_orientation';\nimport rotate from './rotate';\n\n\ntry {\n  require('blueimp-canvas-to-blob'); // polyfill\n} catch (e) {\n  //\n}\n\nexport default (file, { maxDimension = 640, quality = 0.6 } = {}, onResult) => {\n  // get orientation first\n\n  getOrientation(file, (orientation) => {\n    // thx http://stackoverflow.com/questions/23945494/use-html5-to-resize-an-image-before-upload\n    // Load the image\n    const reader = new global.FileReader();\n    reader.onload = (readerEvent) => {\n      const image = new global.Image();\n      image.onload = () => {\n                  // Resize the image\n        const canvas = global.document.createElement('canvas');\n        let width = image.width;\n        let height = image.height;\n\n        if (width > height) {\n          if (width > maxDimension) {\n            height *= maxDimension / width;\n            width = maxDimension;\n          }\n        } else if (height > maxDimension) {\n          width *= maxDimension / height;\n          height = maxDimension;\n        }\n        canvas.width = width;\n        canvas.height = height;\n        rotate(canvas, width, height, orientation);\n        canvas.getContext('2d').drawImage(image, 0, 0, width, height);\n\n        canvas.toBlob((blob) => {\n          onResult(null, blob);\n        }, 'image/jpeg', quality);\n      };\n      image.src = readerEvent.target.result;\n    };\n    reader.readAsDataURL(file);\n  });\n};\n"]}